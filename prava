# Přístupová práva v Unixu (chmod)

Přístupová práva objektu (souboru nebo adresáře) v unixovém systému jsou uložena ve 12 bitech. Pro jejich popis se používá osmičková (oktalová) soustava, protože jedna osmičková číslice popisuje přesně 3 bity.

Práva jsou rozdělena na 4 skupiny (trojice bitů):
1.  **Speciální práva** (SUID, SGID, Sticky bit)
2.  **Vlastník** (User - `u`)
3.  **Skupina** (Group - `g`)
4.  **Ostatní** (Other - `o`)

---

## Základní práva (r, w, x)

Pro každou ze tří kategorií (vlastník, skupina, ostatní) se definují tři základní práva.

| Právo | Hodnota | Popis (Soubor) | Popis (Adresář) |
| :--- | :---: | :--- | :--- |
| `r` (Read) | 4 | Čtení obsahu souboru | Výpis obsahu adresáře |
| `w` (Write) | 2 | Zápis/změna souboru | Vytváření/mazání souborů v adresáři |
| `x` (Execute)| 1 | Spuštění souboru (programu) | Vstup do adresáře (např. pomocí `cd`) |

Hodnoty se sčítají. Například `rw-` (čtení + zápis) je 4 + 2 = **6**. Plná práva `rwx` jsou 4 + 2 + 1 = **7**.

Příklady izolovaných práv (ilustrují systém):
* `0400` = `r-- --- ---` (pouze vlastník smí číst)
* `0200` = `-w- --- ---` (pouze vlastník smí zapisovat)
* `0100` = `--x --- ---` (pouze vlastník smí spouštět)

---

## Speciální práva (SUID, SGID, Sticky bit)

První ze čtyř osmičkových číslic definuje tato speciální práva. Hodnoty se sčítají.

| Právo | Hodnota | Symbol |
| :--- | :---: | :---: |
| SUID | 4 | `u+s` |
| SGID | 2 | `g+s` |
| Sticky Bit| 1 | `a+t` |

### SUID (Set User ID)
* **Hodnota:** `4` (např. `chmod 4755 ...`)
* **Zápis:** `u+s`
* **Zobrazení:** `rwsr-xr-x`

> **Co to dělá (pro soubory):** Když je spustitelný soubor s SUID bitem spuštěn, **běží s právy vlastníka souboru**, nikoliv s právy uživatele, který ho spustil.
>
> **Příklad:** Příkaz `passwd`. Program musí upravit soubor `/etc/shadow`, který vlastní `root`. Aby to mohl udělat i běžný uživatel, má `passwd` nastaven SUID bit a vlastní ho `root`. Program se tak na chvíli spustí jako `root`.
>
> **(Pro adresáře):** Většinou se ignoruje.

### SGID (Set Group ID)
* **Hodnota:** `2` (např. `chmod 2775 ...`)
* **Zápis:** `g+s`
* **Zobrazení:** `rwxr-sr-x`

> **Co to dělá (pro soubory):** Podobné jako SUID. Program se spustí **s právy skupiny, která soubor vlastní**.
>
> **Co to dělá (pro adresáře):** Velmi užitečné. Všechny nové soubory a podadresáře vytvořené v tomto adresáři **automaticky zdědí skupinu nadřazeného adresáře** (místo primární skupiny uživatele). Klíčové pro sdílené složky.

### Sticky Bit
* **Hodnota:** `1` (např. `chmod 1777 ...`)
* **Zápis:** `a+t`
* **Zobrazení:** `rwxrwxrwt`

> **Co to dělá (pro adresáře):** Pokud je nastaveno, soubory v tomto adresáři mohou mazat **pouze jejich vlastníci** (nebo root), bez ohledu na to, zda mají ostatní uživatelé právo zápisu (`w`) do adresáře.
>
> **Příklad:** Adresář `/tmp`. Každý sem může zapisovat, ale díky Sticky bitu nemůže smazat soubory jiného uživatele.
>
> **(Pro soubory):** Většinou se ignoruje.

---

## Příklady použití `chmod`

### Osmičkový (oktalový) zápis

Příkaz má formát `chmod [práva] [soubor]`.

```bash
# Vlastník: rw- (6), Skupina: r-- (4), Ostatní: r-- (4)
# Výsledek: rw-r--r--
chmod 644 soubor.txt

# Vlastník: rwx (7), Skupina: r-x (5), Ostatní: r-x (5)
# Výsledek: rwxr-xr-x
# (Typické pro spustitelný skript nebo adresář)
chmod 755 skript.sh
